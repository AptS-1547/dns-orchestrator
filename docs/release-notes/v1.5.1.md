# v1.5.1 发行说明

## 概述

v1.5.1 是一个增强版本，主要包含 DNS 记录表格交互优化、完整的 Provider 集成测试框架，以及详细的架构文档。这些改进提升了开发体验和代码可维护性。

## 新功能

### DNS 记录文本选择增强

- **@ 记录完整域名显示**：根域名（@）记录现在显示完整域名而非 `@` 符号，提升可读性
- **文本选择支持**：记录名称和值字段支持文本选择，方便复制
- **工具提示**：鼠标悬停在记录名称上显示完整名称

### Provider 集成测试框架

新增完整的集成测试套件，覆盖四个 DNS Provider：

- **Cloudflare**：凭证验证、域名列表、记录 CRUD 等
- **阿里云 DNS**：完整测试覆盖
- **腾讯云 DNSPod**：完整测试覆盖
- **华为云 DNS**：完整测试覆盖

**测试特性**：

- 共享测试工具模块 (`tests/common`)，提供 `TestContext` 和环境变量检查宏
- 支持 SRV 记录的 `_service._protocol` 格式
- 默认标记为 `#[ignore]`，需手动运行，避免影响 CI 流程
- 单线程执行，避免 API 限流问题

## 修复

### 华为云 API 错误响应字段映射

修复华为云 DNS API 错误响应的字段映射问题：

- `error_code` → `code`
- `error_msg` → `message`

## 文档

### 架构文档

新增详细架构文档，涵盖项目各层设计：

- **dns-orchestrator-core**：平台无关的业务逻辑层、ServiceContext、核心 Trait、细粒度服务设计
- **dns-orchestrator-provider**：统一 DNS Provider 抽象、类型安全设计、错误处理机制
- **根目录**：整合四层架构完整描述

### 测试指南

新增 Provider 集成测试指南：

- 环境变量设置说明
- 测试运行方法
- 故障排除指南

**所有文档均提供中英文双语版本。**

## 改进

### 前端组件优化

- `DnsRecordCard`：重构条件样式，使用 `cn` 工具类合并逻辑
- `DnsRecordTable`：使用 `useMemo` 优化域名名称获取，减少重复计算
- `DnsRecordRow`：优化 store 订阅粒度，提升渲染性能

## 技术统计

- **修改文件**：25 个
- **新增代码**：+7,016 行
- **删除代码**：-99 行
- **净增加**：+6,917 行

**主要变更分布**：

- 架构文档：~5,500 行
- 集成测试：~1,300 行
- 前端优化：~60 行

## 升级说明

从 v1.5.0 升级无需额外操作，直接安装新版本即可。

**开发者注意事项**：

- 如需运行集成测试，请参阅 `dns-orchestrator-provider/docs/TESTING.md` 配置环境变量
- 新增架构文档位于各模块的 `docs/` 目录下
