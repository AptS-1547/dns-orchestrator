# v1.3.0 发行说明

## 概述

v1.3.0 是一个重大架构重构版本，主要将业务逻辑提取为平台无关的 `dns-orchestrator-core` 核心库，并对 DNS 提供商模块进行了模块化重构，为未来支持多种后端（Tauri、Actix-Web 等）奠定了坚实基础。

## 架构重构

### 平台无关核心库

- **新增 `dns-orchestrator-core` 库**：将账户、域名、DNS 记录和工具箱等业务逻辑提取为独立 crate
- **存储层抽象**：通过 trait 定义存储接口，支持不同的持久化方案
  - `AccountRepository`：账户数据存储
  - `CredentialStore`：凭证安全存储
  - `ProviderRegistry`：DNS 提供商注册
- **适配器模式**：Tauri 应用重构为适配器层，依赖核心库提供服务
- **Web 后端基础**：为后续 Actix-Web 后端集成做好准备

### DNS 提供商模块化

- **模块化结构**：将 aliyun、cloudflare、dnspod、huaweicloud 提供商从单体文件拆分为模块化结构
  - `mod.rs`：模块入口
  - `provider.rs`：提供商实现
  - `http.rs`：HTTP 请求处理
  - `error.rs`：错误映射
  - `sign.rs`：签名逻辑
  - `types.rs`：类型定义
- **公共功能提取**：`common.rs` 封装各提供商共用的工具函数

## 改进

### 错误处理增强

- **新增错误类型**：`ProviderError` 新增 `DomainLocked` 和 `PermissionDenied` 错误类型
- **原始错误信息**：`InvalidCredentials`、`DomainNotFound` 等错误新增 `raw_message` 字段，便于调试
- **前端类型同步**：更新前端类型定义以支持新的错误结构

### UI 状态管理

- **状态迁移**：将 `expandedAccounts` 和 `scrollPosition` 从组件状态迁移到 `domainStore`
- **滚动位置保持**：返回域名选择页面时自动恢复之前的浏览位置
- **移动端布局优化**：改进响应式布局适配

### CI/CD 优化

- **Release 工作流重构**：新增 `prepare-release` 作业，集中处理 release body 生成
- **消除重复逻辑**：各平台构建作业统一使用预生成的发布内容

## 依赖更新

| 依赖包 | 旧版本 | 新版本 |
|--------|--------|--------|
| @tailwindcss/vite | 4.1.17 | 4.1.18 |
| lucide-react | 0.560.0 | 0.561.0 |
| react | 19.2.1 | 19.2.3 |
| react-dom | 19.2.1 | 19.2.3 |
| react-i18next | 16.4.1 | 16.5.0 |
| tailwindcss | 4.1.17 | 4.1.18 |
| @types/node | 25.0.0 | 25.0.1 |

## 升级说明

从 v1.2.0 升级无需额外操作，直接安装新版本即可。
